<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Whitelist UID - DarkModz Project</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />
  <script>
    let countdown;
    let timeLeft;
    let startTime;

    // Check if there's saved timer data in localStorage
    if(localStorage.getItem('whitelistStartTime') && localStorage.getItem('whitelistTimeLeft')) {
      // Get the time left and start time from localStorage
      timeLeft = parseInt(localStorage.getItem('whitelistTimeLeft'));
      startTime = parseInt(localStorage.getItem('whitelistStartTime'));
    } else {
      // Initialize timer to 2 hours if no data is found in localStorage
      timeLeft = 7200; // 2 hours in seconds
      startTime = Date.now();
      localStorage.setItem('whitelistStartTime', startTime);
    }

    // Function to start the timer
    function startTimer() {
      countdown = setInterval(function () {
        let currentTime = Math.floor((Date.now() - startTime) / 1000);
        timeLeft = 7200 - currentTime; // 7200 seconds = 2 hours

        if (timeLeft <= 0) {
          clearInterval(countdown);
          document.getElementById("timer").innerHTML = "Your whitelist has expired. Please try again.";
          localStorage.removeItem('whitelistStartTime'); // Clear the saved start time when expired
          localStorage.removeItem('whitelistTimeLeft'); // Clear the saved timer data
        } else {
          let hours = Math.floor(timeLeft / 3600);
          let minutes = Math.floor((timeLeft % 3600) / 60);
          let seconds = timeLeft % 60;
          document.getElementById("timer").innerHTML = `Whitelist valid for: ${hours}h ${minutes}m ${seconds}s`;

          // Save the remaining time in localStorage every second
          localStorage.setItem('whitelistTimeLeft', timeLeft);
        }
      }, 1000);
    }

    function whitelistUID() {
      let uid = document.getElementById("uidInput").value;
      if (uid) {
        document.getElementById("uidSection").style.display = "none";
        document.getElementById("timerSection").style.display = "block";
        startTimer();
      } else {
        alert("Please enter a valid UID.");
      }
    }
  </script>
</head>
<body>
  <div class="bg-animation"></div>

  <div class="main-container">
    <h1>Whitelist Your UID</h1>
    <p>Enter your UID below to get whitelisted for 2 hours.</p>

    <!-- UID Input Section -->
    <div id="uidSection">
      <input type="text" id="uidInput" placeholder="Enter your UID" />
      <button class="uid-btn" onclick="whitelistUID()">Submit UID</button>
    </div>

    <!-- Timer Section -->
    <div id="timerSection" style="display:none;">
      <p id="timer">Whitelist valid for: 2h 0m 0s</p>
    </div>
    
    <a class="back-btn" href="index.html">Back to Home</a>
  </div>
</body>
</html>
